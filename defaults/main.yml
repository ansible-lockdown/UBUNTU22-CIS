---

## Switching on/off specific baseline sections
# These variables govern whether the tasks of a particular section are to be executed when running the role.
# E.g: If you want to execute the tasks of Section 1 you should set the "_section1" variable to true.
# to "true". If you do not want the tasks from that section to get executed you simply set the variable to "false".
ubtu22cis_section1: true
ubtu22cis_section2: true
ubtu22cis_section3: true
ubtu22cis_section4: true
ubtu22cis_section5: true
ubtu22cis_section6: true

## Reboot system before audit
# System will reboot if false, can give better audit results
skip_reboot: true

## Benchmark name and profiles used by auditing control role
# The audit variable found at the base
benchmark: UBUNTU22-CIS
benchmark_version: v1.0.0
# Used for audit
ubtu22cis_level_1: true
ubtu22cis_level_2: true

## Possibly disruptive tasks
# This variable governs whether tasks of a potentially disruptive nature on your system
# (e.g., removing .forward and .netrc files for interactive users) are carried out.
# If you set this variable to "true", the role will carry such tasks; if you set it to
# "false", these tasks will be skipped.
ubtu22cis_disruption_high: true

## Unrestricted boot
# Setting this variable to false enables the system to
# boot *without* querying for the bootloader password.
ubtu22cis_ask_passwd_to_boot: false

## Usage on containerized images
# The role discovers dynamically (in tasks/main.yml) whether it
# is executed on a container image and sets the variable
# system_is_container the true. Otherwise, the default value
# 'false' is left unchanged.
system_is_container: false

## Root user used
# Root by default is not used unless setup by user
# The role will only run certain commands if set to true
# This allows the ability to skip tasks that may cause an issue
ubtu22cis_uses_root: false

###
### Settings for associated Audit role using Goss
###

# Note that there are also variable regarding the retrieval
# and configuration of Goss and the audit role at the end
# of this file.

## Audit setup
# Audits are carried out using Goss. This variable
# determines whether execution of the role prepares for auditing
# by installing the required binary.
setup_audit: false
## How to retrieve audit binary
# Options are copy or download, using either the path
# provided in variable `audit_conf_copy` for copying or
# the url given in variable `audit_files_url` for downloading.
get_audit_binary_method: download

## How to retrieve the audit role
# The role for auditing is maintained separately.
# This variable specifies the method of how to get the audit role
# onto the system. The options are as follows:
# - git: clone from git repository as specified in variable `audit_file_git` in
#   the version specified by variable `audit_git_version`
# - copy: copy from path as specified in variable `audit_conf_copy`
# - download: Download from url as specified in variable `audit_files_url`
audit_content: git

## Enable audits to run
# This variable governs whether the audit using the
# separately maintained audit role using Goss
# is carried out.
run_audit: false

## Resource-intensive Tests
# This variable governs whether resource-intensive audit tests are carried out
audit_run_heavy_tests: true
# This variable specifies the timeout (in ms) for audit commands that
# take a very long time: if a command takes too long to complete,
# it will be forcefully terminated after the specified duration.
audit_cmd_timeout: 60000

###
### End Audit Settings for associcated Audit role using Goss
###

## Running role under chroot
# Tweak role to run in a chroot, such as in a kickstart %post script.
# The correct value of this variable is auto-determined.
ubtu22cis_system_is_chroot: "{{ ansible_is_chroot | default(False) }}"

## Running in EC2 pipeline
# Skip events for EC2 instance testing pipeline.
# This variable is set to true for automated tests
# carried out for this role by the role maintainers.
system_is_ec2: false

##
## Rule-specific switches
##
## Use the switches below to disable specific rules independently of the chosen profile
##

## Section 1 Fixes
# Section 1 is Initial setup (FileSystem Configuration, Configure Software Updates, Filesystem Integrity Checking, Secure Boot Settings,
# Additional Process Hardening, Mandatory Access Control, Command Line Warning Banners, and GNOME Display Manager)
ubtu22cis_rule_1_1_1_1: true
ubtu22cis_rule_1_1_1_2: true
ubtu22cis_rule_1_1_1_3: true
ubtu22cis_rule_1_1_2_1: true
ubtu22cis_rule_1_1_2_2: true
ubtu22cis_rule_1_1_2_3: true
ubtu22cis_rule_1_1_2_4: true
ubtu22cis_rule_1_1_3_1: true
ubtu22cis_rule_1_1_3_2: true
ubtu22cis_rule_1_1_3_3: true
ubtu22cis_rule_1_1_4_1: true
ubtu22cis_rule_1_1_4_2: true
ubtu22cis_rule_1_1_4_3: true
ubtu22cis_rule_1_1_4_4: true
ubtu22cis_rule_1_1_5_1: true
ubtu22cis_rule_1_1_5_2: true
ubtu22cis_rule_1_1_5_3: true
ubtu22cis_rule_1_1_5_4: true
ubtu22cis_rule_1_1_6_1: true
ubtu22cis_rule_1_1_6_2: true
ubtu22cis_rule_1_1_6_3: true
ubtu22cis_rule_1_1_6_4: true
ubtu22cis_rule_1_1_7_1: true
ubtu22cis_rule_1_1_7_2: true
ubtu22cis_rule_1_1_7_3: true
ubtu22cis_rule_1_1_8_1: true
ubtu22cis_rule_1_1_8_2: true
ubtu22cis_rule_1_1_8_3: true
ubtu22cis_rule_1_1_9: true
ubtu22cis_rule_1_1_10: true
ubtu22cis_rule_1_2_1: true
ubtu22cis_rule_1_2_2: true
ubtu22cis_rule_1_3_1: true
ubtu22cis_rule_1_3_2: true
ubtu22cis_rule_1_4_1: true
ubtu22cis_rule_1_4_2: true
ubtu22cis_rule_1_4_3: true
ubtu22cis_rule_1_5_1: true
ubtu22cis_rule_1_5_2: true
ubtu22cis_rule_1_5_3: true
ubtu22cis_rule_1_5_4: true
ubtu22cis_rule_1_6_1_1: true
ubtu22cis_rule_1_6_1_2: true
ubtu22cis_rule_1_6_1_3: true
ubtu22cis_rule_1_6_1_4: true
ubtu22cis_rule_1_7_1: true
ubtu22cis_rule_1_7_2: true
ubtu22cis_rule_1_7_3: true
ubtu22cis_rule_1_7_4: true
ubtu22cis_rule_1_7_5: true
ubtu22cis_rule_1_7_6: true
ubtu22cis_rule_1_8_1: true
ubtu22cis_rule_1_8_2: true
ubtu22cis_rule_1_8_3: true
ubtu22cis_rule_1_8_4: true
ubtu22cis_rule_1_8_5: true
ubtu22cis_rule_1_8_6: true
ubtu22cis_rule_1_8_7: true
ubtu22cis_rule_1_8_8: true
ubtu22cis_rule_1_8_9: true
ubtu22cis_rule_1_8_10: true
ubtu22cis_rule_1_9: true

## Section 2 Fixes
# Section 2 is Services (Special Purpose Services, and service clients)
ubtu22cis_rule_2_1_1_1: true
ubtu22cis_rule_2_1_1_2: true
ubtu22cis_rule_2_1_1_3: true
ubtu22cis_rule_2_1_1_4: true
# Chrony
ubtu22cis_rule_2_1_2_1: true
ubtu22cis_rule_2_1_2_2: true
ubtu22cis_rule_2_1_2_3: true
# systemd-timesyncd
ubtu22cis_rule_2_1_3_1: true
ubtu22cis_rule_2_1_3_2: true

# ntp
ubtu22cis_rule_2_1_4_1: true
ubtu22cis_rule_2_1_4_2: true
ubtu22cis_rule_2_1_4_3: true
ubtu22cis_rule_2_1_4_4: true
# Services
ubtu22cis_rule_2_2_1: true
ubtu22cis_rule_2_2_2: true
ubtu22cis_rule_2_2_3: true
ubtu22cis_rule_2_2_4: true
ubtu22cis_rule_2_2_5: true
ubtu22cis_rule_2_2_6: true
ubtu22cis_rule_2_2_7: true
ubtu22cis_rule_2_2_8: true
ubtu22cis_rule_2_2_9: true
ubtu22cis_rule_2_2_10: true
ubtu22cis_rule_2_2_11: true
ubtu22cis_rule_2_2_12: true
ubtu22cis_rule_2_2_13: true
ubtu22cis_rule_2_2_14: true
ubtu22cis_rule_2_2_15: true
ubtu22cis_rule_2_2_16: true
ubtu22cis_rule_2_2_17: true
# Service Client
ubtu22cis_rule_2_3_1: true
ubtu22cis_rule_2_3_2: true
ubtu22cis_rule_2_3_3: true
ubtu22cis_rule_2_3_4: true
ubtu22cis_rule_2_3_5: true
ubtu22cis_rule_2_3_6: true
# Non-essential services
ubtu22cis_rule_2_4: true

## Section 3 Network Configuration
# Disable Unused Network
ubtu22cis_rule_3_1_1: true
ubtu22cis_rule_3_1_2: true
# Network Parameters (Host Only)
ubtu22cis_rule_3_2_1: true
ubtu22cis_rule_3_2_2: true
# Network Parameters (Host and Router)
ubtu22cis_rule_3_3_1: true
ubtu22cis_rule_3_3_2: true
ubtu22cis_rule_3_3_3: true
ubtu22cis_rule_3_3_4: true
ubtu22cis_rule_3_3_5: true
ubtu22cis_rule_3_3_6: true
ubtu22cis_rule_3_3_7: true
ubtu22cis_rule_3_3_8: true
ubtu22cis_rule_3_3_9: true
# Uncommon Network Protocols
ubtu22cis_rule_3_4_1: true
ubtu22cis_rule_3_4_2: true
ubtu22cis_rule_3_4_3: true
ubtu22cis_rule_3_4_4: true
# Firewall Configuration
# UFW
ubtu22cis_rule_3_5_1_1: true
ubtu22cis_rule_3_5_1_2: true
ubtu22cis_rule_3_5_1_3: true
ubtu22cis_rule_3_5_1_4: true
ubtu22cis_rule_3_5_1_5: true
ubtu22cis_rule_3_5_1_6: true
ubtu22cis_rule_3_5_1_7: true
# nftables
ubtu22cis_rule_3_5_2_1: true
ubtu22cis_rule_3_5_2_2: true
ubtu22cis_rule_3_5_2_3: true
ubtu22cis_rule_3_5_2_4: true
ubtu22cis_rule_3_5_2_5: true
ubtu22cis_rule_3_5_2_6: true
ubtu22cis_rule_3_5_2_7: true
ubtu22cis_rule_3_5_2_8: true
ubtu22cis_rule_3_5_2_9: true
ubtu22cis_rule_3_5_2_10: true
# iptables
ubtu22cis_rule_3_5_3_1_1: true
ubtu22cis_rule_3_5_3_1_2: true
ubtu22cis_rule_3_5_3_1_3: true
ubtu22cis_rule_3_5_3_2_1: true
ubtu22cis_rule_3_5_3_2_2: true
ubtu22cis_rule_3_5_3_2_3: true
ubtu22cis_rule_3_5_3_2_4: true
ubtu22cis_rule_3_5_3_3_1: true
ubtu22cis_rule_3_5_3_3_2: true
ubtu22cis_rule_3_5_3_3_3: true
ubtu22cis_rule_3_5_3_3_4: true

## Section 4 Fixes
# Section 4 is Logging and Auditing (Configure System Accounting (auditd), Configure Data Retention, and Configure Logging)
ubtu22cis_rule_4_1_1_1: true
ubtu22cis_rule_4_1_1_2: true
ubtu22cis_rule_4_1_1_3: true
ubtu22cis_rule_4_1_1_4: true
ubtu22cis_rule_4_1_2_1: true
ubtu22cis_rule_4_1_2_2: true
ubtu22cis_rule_4_1_2_3: true
# Auditd rules
ubtu22cis_rule_4_1_3_1: true
ubtu22cis_rule_4_1_3_2: true
ubtu22cis_rule_4_1_3_3: true
ubtu22cis_rule_4_1_3_4: true
ubtu22cis_rule_4_1_3_5: true
ubtu22cis_rule_4_1_3_6: true
ubtu22cis_rule_4_1_3_7: true
ubtu22cis_rule_4_1_3_8: true
ubtu22cis_rule_4_1_3_9: true
ubtu22cis_rule_4_1_3_10: true
ubtu22cis_rule_4_1_3_11: true
ubtu22cis_rule_4_1_3_12: true
ubtu22cis_rule_4_1_3_13: true
ubtu22cis_rule_4_1_3_14: true
ubtu22cis_rule_4_1_3_15: true
ubtu22cis_rule_4_1_3_16: true
ubtu22cis_rule_4_1_3_17: true
ubtu22cis_rule_4_1_3_18: true
ubtu22cis_rule_4_1_3_19: true
ubtu22cis_rule_4_1_3_20: true
ubtu22cis_rule_4_1_3_21: true
# Auditd file access
ubtu22cis_rule_4_1_4_1: true
ubtu22cis_rule_4_1_4_2: true
ubtu22cis_rule_4_1_4_3: true
ubtu22cis_rule_4_1_4_4: true
ubtu22cis_rule_4_1_4_5: true
ubtu22cis_rule_4_1_4_6: true
ubtu22cis_rule_4_1_4_7: true
ubtu22cis_rule_4_1_4_8: true
ubtu22cis_rule_4_1_4_9: true
ubtu22cis_rule_4_1_4_10: true
ubtu22cis_rule_4_1_4_11: true
# Configure Logging
## journald
ubtu22cis_rule_4_2_1_1_1: true
ubtu22cis_rule_4_2_1_1_2: true
ubtu22cis_rule_4_2_1_1_3: true
ubtu22cis_rule_4_2_1_1_4: true
ubtu22cis_rule_4_2_1_1: true
ubtu22cis_rule_4_2_1_2: true
ubtu22cis_rule_4_2_1_3: true
ubtu22cis_rule_4_2_1_4: true
ubtu22cis_rule_4_2_1_5: true
ubtu22cis_rule_4_2_1_6: true
ubtu22cis_rule_4_2_1_7: true
# rsyslog
ubtu22cis_rule_4_2_2_1: true
ubtu22cis_rule_4_2_2_2: true
ubtu22cis_rule_4_2_2_3: true
ubtu22cis_rule_4_2_2_4: true
ubtu22cis_rule_4_2_2_5: true
ubtu22cis_rule_4_2_2_6: true
ubtu22cis_rule_4_2_2_7: true
ubtu22cis_rule_4_2_3: true
ubtu22cis_rule_4_3: true
ubtu22cis_rule_4_4: true

## Section 5 Fixes
# Section 5 is Access, Authentication, and Authorization (Configure time-based job schedulers, Configure sudo, Configure SSH Server, Configure PAM
# and User Accounts and Environment)
ubtu22cis_rule_5_1_1: true
ubtu22cis_rule_5_1_2: true
ubtu22cis_rule_5_1_3: true
ubtu22cis_rule_5_1_4: true
ubtu22cis_rule_5_1_5: true
ubtu22cis_rule_5_1_6: true
ubtu22cis_rule_5_1_7: true
ubtu22cis_rule_5_1_8: true
ubtu22cis_rule_5_1_9: true

ubtu22cis_rule_5_2_1: true
ubtu22cis_rule_5_2_2: true
ubtu22cis_rule_5_2_3: true
ubtu22cis_rule_5_2_4: true
ubtu22cis_rule_5_2_5: true
ubtu22cis_rule_5_2_6: true
ubtu22cis_rule_5_2_7: true
ubtu22cis_rule_5_2_8: true
ubtu22cis_rule_5_2_9: true
ubtu22cis_rule_5_2_10: true
ubtu22cis_rule_5_2_11: true
ubtu22cis_rule_5_2_12: true
ubtu22cis_rule_5_2_13: true
ubtu22cis_rule_5_2_14: true
ubtu22cis_rule_5_2_15: true
ubtu22cis_rule_5_2_16: true
ubtu22cis_rule_5_2_17: true
ubtu22cis_rule_5_2_18: true
ubtu22cis_rule_5_2_19: true
ubtu22cis_rule_5_2_20: true
ubtu22cis_rule_5_2_21: true
ubtu22cis_rule_5_2_22: true
ubtu22cis_rule_5_3_1: true
ubtu22cis_rule_5_3_2: true
ubtu22cis_rule_5_3_3: true
ubtu22cis_rule_5_3_4: true
ubtu22cis_rule_5_3_5: true
ubtu22cis_rule_5_3_6: true
ubtu22cis_rule_5_3_7: true
ubtu22cis_rule_5_4_1: true
ubtu22cis_rule_5_4_2: true
ubtu22cis_rule_5_4_3: true
ubtu22cis_rule_5_4_4: true
ubtu22cis_rule_5_4_5: true
ubtu22cis_rule_5_5_1_1: true
ubtu22cis_rule_5_5_1_2: true
ubtu22cis_rule_5_5_1_3: true
ubtu22cis_rule_5_5_1_4: true
ubtu22cis_rule_5_5_1_5: true
ubtu22cis_rule_5_5_2: true
ubtu22cis_rule_5_5_3: true
ubtu22cis_rule_5_5_4: true
ubtu22cis_rule_5_5_5: true
ubtu22cis_rule_5_6: true
ubtu22cis_rule_5_7: true

## Section 6 Fixes
# Section is System Maintenance (System File Permissions and User and Group Settings)
ubtu22cis_rule_6_1_1: true
ubtu22cis_rule_6_1_2: true
ubtu22cis_rule_6_1_3: true
ubtu22cis_rule_6_1_4: true
ubtu22cis_rule_6_1_5: true
ubtu22cis_rule_6_1_6: true
ubtu22cis_rule_6_1_7: true
ubtu22cis_rule_6_1_8: true
ubtu22cis_rule_6_1_9: true
ubtu22cis_rule_6_1_10: true
ubtu22cis_rule_6_1_11: true
ubtu22cis_rule_6_1_12: true
ubtu22cis_rule_6_1_13: true
ubtu22cis_rule_6_2_1: true
ubtu22cis_rule_6_2_2: true
ubtu22cis_rule_6_2_3: true
ubtu22cis_rule_6_2_4: true
ubtu22cis_rule_6_2_5: true
ubtu22cis_rule_6_2_6: true
ubtu22cis_rule_6_2_7: true
ubtu22cis_rule_6_2_8: true
ubtu22cis_rule_6_2_9: true
ubtu22cis_rule_6_2_10: true
ubtu22cis_rule_6_2_11: true
ubtu22cis_rule_6_2_12: true
ubtu22cis_rule_6_2_13: true
ubtu22cis_rule_6_2_14: true
ubtu22cis_rule_6_2_15: true
ubtu22cis_rule_6_2_16: true
ubtu22cis_rule_6_2_17: true

##
## Service configuration variables.
##
## Set the respective variable to true to keep the service.
## otherwise the service is stopped and disabled
##

ubtu22cis_allow_autofs: false
ubtu22cis_allow_usb_storage: false
ubtu22cis_avahi_server: false
ubtu22cis_cups_server: false
ubtu22cis_dhcp_server: false
ubtu22cis_ldap_server: false
ubtu22cis_nfs_server: false
ubtu22cis_dns_server: false
ubtu22cis_vsftpd_server: false
ubtu22cis_httpd_server: false
ubtu22cis_dovecot_server: false
ubtu22cis_smb_server: false
ubtu22cis_squid_server: false
ubtu22cis_snmp_server: false
ubtu22cis_rsync_server: false
ubtu22cis_nis_server: false
ubtu22cis_nfs_client: false

# rpcbind is required by nfs-common which is required on client and server
# The value of the variable is determined automatically, based on the variables
# for NFS server and NFS client.
ubtu22cis_rpc_required: "{{ ubtu22cis_nfs_server or ubtu22cis_nfs_client }}"

##
## Client package configuration variables.
##
## Set the respective variable to `true` to keep the
## client package, otherwise it is uninstalled.
##

ubtu22cis_nis_required: false
ubtu22cis_rsh_required: false
ubtu22cis_talk_required: false
ubtu22cis_telnet_required: false
ubtu22cis_ldap_clients_required: false

##
## System functionality configuration variables
##
## There are certain functionalities of a system
## that may require either to skip certain CIS rules
## or install certain packages.
## Set the respective variable to `true` in order to
## enable a certain functionality on the system

# This variable governs whether specific CIS rules
# concerned with acceptance and routing of packages
# are skipped.
ubtu22cis_is_router: false

## IPv4 requirement toggle
# This variable governs whether ipv4 is enabled or disabled.
ubtu22cis_ipv4_required: true

## IPv6 requirement toggle
# This variable governs whether ipv6 is enabled or disabled.
ubtu22cis_ipv6_required: false

## Desktop requirement toggle
# This variable governs, whether CIS rules regarding GDM
# and X-Windows are carried out.
ubtu22cis_desktop_required: false

##
## Section 1 Control Variables
##

## tmp mount type
# This variable determines, to which mount type
# the tmp mount type will be set, if it cannot be
# correctly discovered. will force the tmp_mnt type
# if not correctly discovered.
# Possible values are `tmp_systemd` or `fstab`-
expected_tmp_mnt: fstab

## Control 1.3.1 - allow aide to be configured
# AIDE is a file integrity checking tool, similar in nature to Tripwire.
# While it cannot prevent intrusions, it can detect unauthorized changes
# to configuration files by alerting when the files are changed. Review
# the AIDE quick start guide and AIDE documentation before proceeding.
# By setting this variable to `true`, all of the settings related to AIDE will be applied!
ubtu22cis_config_aide: true

## Control 1.3.2
# These are the crontab settings for periodical checking of the filesystem's integrity using AIDE.
# The sub-settings of this variable provide the parameters required to configure
# the cron job on the target system.
# Cron is a time-based job scheduling program in Unix OS, which allows tasks to be scheduled
# and executed automatically at a certain point in time.
ubtu22cis_aide_cron:
    # This variable represents the user account under which the cron job for AIDE will run.
    cron_user: root
    # This variable represents the path to the AIDE crontab file.
    cron_file: /etc/cron.d/aide_cron
    # This variable represents the actual command or script that the cron job
    # will execute for running AIDE.
    aide_job: '/usr/bin/aide --config /etc/aide/aide.conf --check'
    # These variables define the schedule for the cron job
    # This variable governs the minute of the time of day when the AIDE cronjob is run.
    # It must be in the range `0-59`.
    aide_minute: 0
    # This variable governs the hour of the time of day when the AIDE cronjob is run.
    # It must be in the range `0-23`.
    aide_hour: 5
    # This variable governs the day of the month when the AIDE cronjob is run.
    # `*` signifies that the job is run on all days; furthermore, specific days
    # can be given in the range `1-31`; several days can be concatenated with a comma.
    # The specified day(s) can must be in the range  `1-31`.
    aide_day: '*'
    # This variable governs months when the AIDE cronjob is run.
    # `*` signifies that the job is run in every month; furthermore, specific months
    # can be given in the range `1-12`; several months can be concatenated with commas.
    # The specified month(s) can must be in the range  `1-12`.
    aide_month: '*'
    # This variable governs the weekdays, when the AIDE cronjob is run.
    # `*` signifies that the job is run on all weekdays; furthermore, specific weekdays
    # can be given in the range `0-7` (both `0` and `7` represent Sunday); several weekdays
    # can be concatenated with commas.
    aide_weekday: '*'

## Controls 1.4.x - Boot password
#
# THIS VARIABLE SHOULD BE CHANGED AND INCORPORATED INTO VAULT
# THIS VALUE IS WHAT THE ROOT PW WILL BECOME!!!!!!!!
# HAVING THAT PW EXPOSED IN RAW TEXT IS NOT SECURE!!!!
ubtu22cis_grub_user: root
ubtu22cis_set_grub_user_pass: false
ubtu22cis_grub_user_passwd: '$y$j9T$MBA5l/tQyWifM869nQjsi.$cTy0ConcNjIYOn6Cppo5NAky20osrkRxz4fEWA8xac6'  # Set to changeme
ubtu22cis_grub_user_file: /etc/grub.d/00_user
ubtu22cis_bootloader_password_hash: "grub.pbkdf2.sha512.changethispassword"  # pragma: allowlist secret
ubtu22cis_set_boot_pass: true

ubtu22cis_grub_file: /boot/grub/grub.cfg

## Controls 1.6.1.x - apparmor
# AppArmor security policies define what system resources applications can access and their privileges.
# This automatically limits the damage that the software can do to files accessible by the calling user.
# The following variables are related to the set of rules from section 1.6.1.x

# This variable disables the rule regarding enforcing profiles or putting them in complain mode
ubtu22cis_apparmor_disable: false
# This variable chooses how the profiles will comply to rule 1.6.1.3.
# If it is set to true the profiles will be in enforce mode
# If it is set to false the profiles will be in complain mode
# *? The role has two tasks that do the same thing no matter what boolean
# value is set to this variable *?
ubtu22cis_apparmor_enforce_only: false

## Controls 1.7.x  - Warning banners
# The controls 1.7.x set various warning banners and protect the respective files
# by tightening the access rights.

# This variable specifies the warning banner displayed to the user
# after local login, remote login, and as motd (message of the day)
# Noe that the banner text must not contain the below items in order to be
# compliant with CIS: \m, \r, \s, \v or references to the OS platform
ubtu22cis_warning_banner: |
        Authorized uses only. All activity may be monitored and reported.

# This variable governs, whether dynamic motd is disabled (as required by control 1.7.1)
ubtu22cis_disable_dynamic_motd: true

## Controls 1.8.x - Settings for GDM
# This variable specifies the GNOME configuration database file to which configurations are written.
# (See https://help.gnome.org/admin/system-admin-guide/stable/dconf-keyfiles.html.en)
# The default database is `local`.
ubtu22cis_dconf_db_name: local
# This variable governs the number of seconds of inactivity before the screen goes blank.
ubtu22cis_screensaver_idle_delay: 900
# This variable governs the number of seconds the screen remains blank before it is locked.
ubtu22cis_screensaver_lock_delay: 5

##
## Section 2 Control Variables
##

## Control 2.1.1.1
# This variable choses the tool used for time synchronization
# The three options are `chrony`, `ntp`, and `systemd-timesyncd`.
ubtu22cis_time_sync_tool: "ntp"

## Controls 2.1.2.1 2.1.3.1, 2.1.4.1 - Configure time pools & servers for chrony, timesyncd, and ntp
# The following variable represents a list of of time server pools used
# for configuring chrony, timesyncd, and ntp.
# Each list item contains two settings, `name` (the domain name of the pool) and synchronization `options`.
# The default setting for the `options` is `iburst maxsources 4` -- please refer to the documentation
# of the time synchronization mechanism you are using.
ubtu22cis_time_pool:
    - name: time.nist.gov
      options: iburst maxsources 4
# The following variable represents a list of of time servers used
# for configuring chrony, timesyncd, and ntp.
# Each list item contains two settings, `name` (the domain name of the server) and synchronization `options`.
# The default setting for the `options` is `iburst` -- please refer to the documentation
# of the time synchronization mechanism you are using.
ubtu22cis_time_servers:
    - name: time-a-g.nist.gov
      options: iburst
    - name: time-b-g.nist.gov
      options: iburst
    - name: time-c-g.nist.gov
      options: iburst

## Control 2.2.15 - Local only mode for mail server
# This variable is used to determine whether you intend to use your machine as a mail server or not.
# If you do not intend to use it as such, the mail transfer agent (MTA) will be configured to only
# process local mail, in order to reduce chances of security risks. Set to `false` if your machine
# is not a mail server or to `true` if it is!
ubtu22cis_is_mail_server: false

##
## Section 3 Control Variables
##

## Control 3.1.1 - Ensure system is checked to determine if IPv6 is enabled
# This variable governs the mechanism of how the disabling of IPV6 is carried out.
# Its possible values are `grub` and `sysctl`.
ubtu22cis_ipv6_disable: grub

## Control 3.1.2 - Ensure wireless interfaces are disabled
# This variable is used for a preliminary task regarding the installation of Network Manager
# If it is set to `true`, Network Manager is installed during the "prelim" section of
# the role. If set to `false`, Network Manager is not installed. Bear in mind that without
# it, ensuring that wireless interfaces are disabled will not be possible!
ubtu22cis_install_network_manager: true

## Control 3.3.x - Networking configuration
# This variable contains the path to the file in which, sysctl saves its configurations.
# Its default value is `/etc/sysctl.conf`.
ubtu22cis_sysctl_network_conf: /etc/sysctl.conf

## Controls 3.5.1.x, 3.5.2.x, and 3.5.3.x - Firewall configuration
# This variable represents the toggle for which firewall package is used.
# The options that have an effect on the system are `ufw` and `iptables`.
# The option `nftables` is also possible, but will only result in a message,
# that `nftables` has been chosen; all settings have to be carried out manually.
# Any other value, e.g. `none` will skip all firewall-related controls.
ubtu22cis_firewall_package: "ufw"

# This variable is used in a preliminary task that forces the UFW firewall to use /etc/sysctl.conf
# settings. If set to "true" the task will get done in the prelim section of the role.
ubtu22cis_ufw_use_sysctl: true

## Control 3.5.1.5 - Ensure ufw outbound connections are configured
# The value of this variable represents the ports for the firewall to allow oubound traffic from.
# If you want to allow outbound traffic on all ports, set the variable to  `all`, e.g.,
# `ubtu22cis_ufw_allow_out_ports: "all"`.
ubtu22cis_ufw_allow_out_ports:
    - 53
    - 80
    - 443

## Controls 3.5.2.x - nftables
# Nftables is not supported in this role. Some tasks have parts of them commented out, this is one example
# of such a task.
# "ubtu22cis_nftables_table_name" is the name of the table in nftables you want to create.
# The default nftables table name is "inet filter". This variable name will be the one all
# nftables configs are applied to.
# ubtu22cis_nftables_table_name: "inet filter"

##
## Section 4 Control Variables
##

##  Control 4.1.1.4 - Ensure audit_backlog_limit is sufficient
# This variable represents the audit backlog limit, i.e., the maximum number of audit records that the
# system can buffer in memory, if the audit subsystem is unable to process them in real-time.
# Buffering in memory is useful in situations, where the audit system is overwhelmed
# with incoming audit events, and needs to temporarily store them until they can be processed.
# This variable should be set to a sufficient value. The CIS baseline recommends at least `8192` as value.
ubtu22cis_audit_back_log_limit: 8192

## Control 4.1.2.1 - Ensure audit log storage size is configured
# This variable specifies the maximum size in MB that an audit log file can reach
# before it is archived or deleted to make space for the new audit data.
# This should be set based on your sites policy. CIS does not provide a specific value.
ubtu22cis_max_log_file_size: 10

## 4.1.3.x - Audit template
# This variable is set to true by tasks 4.1.3.1 to 4.1.3.20. As a result, the
# audit settings are overwritten with the role's template. In order to exclude
# specific rules, you must set the variable of form `ubtu22cis_rule_4_1_3_x` above
# to `false`.
update_audit_template: false

## Advanced option found in auditd post
## users whose actions are not logged by auditd
ubtu22cis_allow_auditd_uid_user_exclusions: false
# add a list of uids
ubtu22cis_auditd_uid_exclude:
    - 1999

## Controls 4.1.2.2 and 4.1.2.3 - What to do when log files fill up
# This variable controls how the audit system behaves when
# log files are getting too full and space is getting too low.
ubtu22cis_auditd:
    action_mail_acct: root
    space_left_action: email
    # This variable determines the action the audit system should take when disk
    # space runs low.
    # The options for setting this variable are as follows:
    # - `ignore`: the system does nothing when presented with the aforementioned issue;
    # - `syslog`: a message is sent to the system log about disk space running low;
    # - `suspend`: the system suspends recording audit events until more space is available;
    # - `halt`: the system is halted when disk space is critically low.
    # - `single`: the audit daemon will put the computer system in single user mode
    # CIS prescribes either `halt` or `single`.
    admin_space_left_action: halt
    # This variable determines what action the audit system should take when the maximum
    # size of a log file is reached.
    # The options for setting this variable are as follows:
    # - `ignore`: the system does nothing when the size of a log file is full;
    # - `syslog`: a message is sent to the system log indicating the problem;
    # - `suspend`: the system suspends recording audit events until the log file is cleared or rotated;
    # - `rotate`: the log file is rotated (archived) and a new empty log file is created;
    # - `keep_logs`: the system attempts to keep as many logs as possible without violating disk space constraints.
    # CIS prescribes the value `keep_logs`.
    max_log_file_action: keep_logs

## Controls 4.2.1.x (`journald`) and 4.2.2.x (`rsyslog`)
# This variable governs which logging system is used.
# The options for this variable are `rsyslog` or `journald`.
ubtu22cis_syslog_service: rsyslog
# This variable specifies the address of the remote log host where logs are being sent.
ubtu22cis_remote_log_server: 192.168.2.100
# This variable expresses whether the system is used as a log server or not.
# If set to `true`, controls that interfere with log server functionality or
# require that own system logs be sent to some other log server are skipped.
ubtu22cis_system_is_log_server: false

## Controls 4.2.1.1.x & 4.2.1.x journald
# This variable specifies the path to the private key file used by the remote journal
# server to authenticate itself to the client. This key is used alongside the server's
# public certificate to establish secure communication.
ubtu22cis_journal_upload_serverkeyfile:
# This variable specifies the path to the public certificate file of the remote journal
# server. This certificate is used to verify the authenticity of the remote server.
ubtu22cis_journal_servercertificatefile:
# This variable specifies the path to a file containing one or more public certificates
# of certificate authorities (CAs) that the client trusts. These trusted certificates are used
# to validate the authenticity of the remote server's certificate.
ubtu22cis_journal_trustedcertificatefile:
# These variable specifies how much disk space the journal may use up at most
# Specify values in bytes or use K, M, G, T, P, E as units for the specified sizes.
# See https://www.freedesktop.org/software/systemd/man/journald.conf.html for more information.
# ATTENTION: Uncomment the keyword below when values are set!
ubtu22cis_journald_systemmaxuse: "#SystemMaxUse="
ubtu22cis_journald_systemkeepfree: "#SystemKeepFree="
ubtu22cis_journald_runtimemaxuse: "#RuntimeMaxUse="
ubtu22cis_journald_runtimekeepfree: "#RuntimeKeepFree="
# This variable specifies, the maximum time to store entries in a single journal
# file before rotating to the next one. Set to 0 to turn off this feature.
# The given values is interpreted as seconds, unless suffixed with the units
# `year`, `month`, `week`, `day`, `h` or `m` to override the default time unit of seconds.
# ATTENTION: Uncomment the keyword below when values are set!
ubtu22cis_journald_maxfilesec: "#MaxFileSec="

## Controls 4.2.2.x Rsyslog
# This variable governs whether the rsyslog configuration is to be set by this Ansible role.
# Set it to `true` to configure via Ansible and to `false` otherwise.
ubtu22cis_rsyslog_ansible_managed: true

##
## Section 5 Control Variables
##

## Controls 5.2.4/5/13/14/15/18/20/21/22 -- various sshd settings
ubtu22cis_sshd:
    # This variable is used to control the verbosity of the logging produced by the SSH server.
    # The options for setting it are as follows:
    # - `QUIET`: Minimal logging;
    # - `FATAL`: logs only fatal errors;
    # - `ERROR`: logs error messages;
    # - `INFO`: logs informational messages in addition to errors;
    # - `VERBOSE`: logs a higher level of detail, including login attempts and key exchanges;
    # - `DEBUG`: generates very detailed debugging information including sensitive information.
    log_level: "INFO"
    # This variable specifies the maximum number of authentication attempts that are
    # allowed for a single SSH session.
    max_auth_tries: 4
    # This variable specifies the encryption algorithms that can be used for securing
    # data transmission.
    ciphers: "chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr"
    # This variable specifies a list of message authentication code algorithms (MACs) that are allowed for verifying
    # the integrity of data exchanged.
    macs: "hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256"
    # This variable is used to state the key exchange algorithms used to establish secure encryption
    # keys during the initial connection setup.
    kex_algorithms: "curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256"
    # This variable sets the time interval in seconds between sending "keep-alive"
    # messages from the server to the client. These types of messages are intended to
    # keep the connection alive and prevent it being terminated due to inactivity.
    client_alive_interval: 300
    # This variable sets the maximum number of unresponsive "keep-alive" messages
    # that can be sent from the server to the client before the connection is considered
    # inactive and thus, closed.
    client_alive_count_max: 3
    # This variable specifies the amount of seconds allowed for successful authentication to
    # the SSH server.
    login_grace_time: 60
    # This variables is used to set the maximum number of open sessions per connection.
    max_sessions: 8
    # This variable, if specified, configures a list of USER name patterns, separated by spaces, to allow SSH
    # access for users whose user name matches one of the patterns. This is done
    # by setting the value of `AllowUsers` option in `/etc/ssh/sshd_config` file.
    # If an USER@HOST format will be used, the specified user will be allowed only on that particular host.
    # The allow/deny directives process order: DenyUsers, AllowUsers, DenyGroups, AllowGroups.
    # For more info, see https://linux.die.net/man/5/sshd_config
    allow_users: "vagrant ubuntu"
    # (String) This variable, if spcieifed, configures a list of GROUP name patterns, separated by spaces, to allow SSH access
    # for users whose primary group or supplementary group list matches one of the patterns. This is done
    # by setting the value of `AllowGroups` option in `/etc/ssh/sshd_config` file.
    # The allow/deny directives process order: DenyUsers, AllowUsers, DenyGroups, AllowGroups.
    # For more info, https://linux.die.net/man/5/sshd_config
    allow_groups: "vagrant ubuntu"
    # This variable, if specified, configures a list of USER name patterns, separated by spaces, to prevent SSH access
    # for users whose user name matches one of the patterns. This is done
    # by setting the value of `DenyUsers` option in `/etc/ssh/sshd_config` file.
    # If an USER@HOST format will be used, the specified user will be restricted only on that particular host.
    # The allow/deny directives process order: DenyUsers, AllowUsers, DenyGroups, AllowGroups.
    # For more info, see https://linux.die.net/man/5/sshd_config
    deny_users: ""
    # This variable, if specified, configures a list of GROUP name patterns, separated by spaces, to prevent SSH access
    # for users whose primary group or supplementary group list matches one of the patterns. This is done
    # by setting the value of `DenyGroups` option in `/etc/ssh/sshd_config` file.
    # The allow/deny directives process order: DenyUsers, AllowUsers, DenyGroups, AllowGroups.
    # For more info, see https://linux.die.net/man/5/sshd_config
    deny_groups: ""

## Control 5.3.1
# This variable represents the name of the sudo package to install
# CIS recommends `sudo` or, if LDAP functionality is required, `sudo-ldap`.
ubtu22cis_sudo_package: "sudo"

## Control 5.3.3
# This variable defines the path and file name of the sudo log file.
ubtu22cis_sudo_logfile: "/var/log/sudo.log"
##  Control 5.3.6
# This variable sets the duration (in minutes) during which a user's authentication credentials
# are cached after successfully authenticating using "sudo". This allows the user to execute
# multiple commands with elevated privileges without needing to re-enter their password for each
# command within the specified time period. CIS requires a value of at most 15 minutes.
ubtu22cis_sudo_timestamp_timeout: 15
## Control 5.3.7
# This variable determines the group of users that are allowed to use the su command.
# one to specify a user group that is allowed to use the "su" command.
# CIS requires that such a group be created (named according to site policy) and be kept empty.
ubtu22cis_sugroup: nosugroup

## Control 5.4.3
# This variable represents the number of password change cycles, after which
# a user can re-use a password.
# CIS requires a value of 5 or more.
ubtu22cis_pamd_pwhistory_remember: 5

# Control 5.4.4
# ubtu22cis_passwd_hash_algo is the hashing algorithm used
ubtu22cis_passwd_hash_algo: yescrypt  # pragma: allowlist secret
# Set pam as well as login defs if PAM is required
ubtu22cis_passwd_setpam_hash_algo: false

## Controls 5.5.1.x - Password settings
ubtu22cis_pass:
    ## Control 5.5.1.2
    # This variable governs after how many days a  password expires.
    # CIS requires a value of 365 or less.
    max_days: 365
    ## Control 5.5.1.1
    # This variable specifies the minimum number of days allowed between changing passwords.
    # CIS requires a value of at least 1.
    min_days: 1
    ## Control 5.5.1.3
    # This variable governs, how many days before a password expires, the user will be warned.
    # CIS requires a value of at least 7.
    warn_age: 7
    ## Control 5.5.1.4
    # This variable specifies the number of days of inactivity before an account will be locked.
    # CIS requires a value of 30 days or less.
    inactive: 30

## Control 5.5.4 - Default user mask
# The following variable specifies the "umask" to set in the `/etc/bash.bashrc` and `/etc/profile`.
# The value needs to be `027` or more restrictive to comply with CIS standards
ubtu22cis_bash_umask: '027'

## Control 5.5.5 - Configuring user shell timeout
# This dictionary is related to ensuring the rule about user shell timeout
ubtu22cis_shell_session_timeout:
    # This variable specifies the path of the timeout setting file.
    # (TMOUT setting can be set in multiple files, but only one is required for the
    # rule to pass. Options are:
    # - a file in `/etc/profile.d/` ending in `.s`,
    # - `/etc/profile`, or
    # - `/etc/bash.bashrc`.
    file: /etc/profile.d/tmout.sh
    # This variable represents the amount of seconds a command or process is allowed to
    # run before being forcefully terminated.
    # CIS requires a value of at most 900 seconds.
    timeout: 900

##
## Section 6 Control Variables
##

## Controls 6.2.11 & 6.2.12
# The minimum and maximum UIDs to be used when enforcing
# and checking controls 6.2.11 and 6.2.12 can either be
# discovered automatically via logins.def or set manually
# in this file
# If min/maxx UIDs are to be discovered automatically,
# set this variable to `true`, otherwise to `false`.
discover_int_uid: false
# This variable sets the minimum number from which to search for UID
# Note that the value will be dynamically overwritten if variable `dicover_int_uid` has
# been set to `true`.
min_int_uid: 1000

# This variable sets the maximum number at which the search stops for UID
# Note that the value will be dynamically overwritten if variable `dicover_int_uid` has
# been set to `true`.
max_int_uid: 65533

## Control 6.1.9
# The following variable is a toggle for enabling/disabling the automated
# removal of world-writable permissions from all files.
# Possible values are `true` and `false`.
ubtu22cis_no_world_write_adjust: true

# Control 6.1.10
# The value of this variable specifies the owner that will be set for unowned files and directories.
ubtu22cis_unowned_owner: root
# This variable is a toggle for enabling/disabling the automated
# setting of an owner (specified in variable `ubtu22cis_unowned_owner`)
# for all unowned files and directories.
# Possible values are `true` and `false`.
ubtu22cis_no_owner_adjust: true

## Control 6.1.11
# This variable represents the group that will be set for files without group.
ubtu22cis_ungrouped_group: root
# This variable is a toggle for enabling/disabling the automated
# assignment of a group (specified in variable `ubtu22cis_unowned_group`)
# for all group-less files and directories.
# Possible values are `true` and `false`.
ubtu22cis_no_group_adjust: true

## Control 6.1.12
# This variable is a toggle for enabling/disabling the automated removal
# of the SUID bit from all files on all mounts.
# Possible values are `true` and `false`.
ubtu22cis_suid_adjust: false

## Control 6.1.13
# This variable is a toggle for enabling/disabling the automated removal the SGID
# bit from all files on all mounts
# Possible values are `true` and `false`.
ubtu22cis_sgid_adjust: false

## Control 6.2.7
# This variable is a toggle foe enabling/disabling the automated modification of
# permissions on dot files.
# Possible values are `true` and `false`.
ubtu22cis_dotperm_ansiblemanaged: true

##
## Audit Configuration Settings
##

# The settings below configure the retrieval and usage of the
# Goss-based audit role associated with this role, and the Goss-tool
# itself.

## Audit binary settings
audit_bin_version:
    release: v0.4.0
    checksum: 'sha256:9cb37863d3d25e2af80cb5cf55198c0c115b2477724153ba9afd0a2e544cb46e'
audit_bin_path: /usr/local/bin/
audit_bin: "{{ audit_bin_path }}goss"
audit_format: json

# if get_audit_binary_method == download change accordingly
audit_bin_url: "https://github.com/goss-org/goss/releases/download/{{ audit_bin_version.release }}/goss-linux-amd64"

# if get_audit_binary_method - copy the following needs to be updated for your environment
# it is expected that it will be copied from somewhere accessible to the control node
# e.g copy from ansible control node to remote host
audit_bin_copy_location: /some/accessible/path

## Goss Audit Benchmark file
# managed by the control audit_content
# git
audit_file_git: "https://github.com/ansible-lockdown/{{ benchmark }}-Audit.git"
audit_git_version: "benchmark-{{ benchmark_version }}"

# archive or copy:
audit_conf_copy: "some path to copy from"

# get_url:
audit_files_url: "some url maybe s3?"

## Goss configuration information
# Where the goss configs and outputs are stored
audit_out_dir: '/opt'
# Where the goss audit configuration will be stored
audit_conf_dir: "{{ audit_out_dir }}/{{ benchmark }}-Audit"

# If changed these can affect other products
pre_audit_outfile: "{{ audit_out_dir }}/{{ ansible_hostname }}-{{ benchmark }}-{{ benchmark_version }}_pre_scan_{{ ansible_date_time.epoch }}.{{ audit_format }}"
post_audit_outfile: "{{ audit_out_dir }}/{{ ansible_hostname }}-{{ benchmark }}-{{ benchmark_version }}_post_scan_{{ ansible_date_time.epoch }}.{{ audit_format }}"

## The following should not need changing
audit_vars_path: "{{ audit_conf_dir }}/vars/{{ ansible_hostname }}.yml"
audit_results: |
      The pre remediation results are: {{ pre_audit_summary }}.
      The post remediation results are: {{ post_audit_summary }}.
      Full breakdown can be found in {{ audit_out_dir }}
